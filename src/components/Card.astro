---
const { height = 480 } = Astro.props;
---

<div class="card">
  <div class="card__shadow"></div>
  <div class="card__body">
    <slot />
  </div>
</div>

<style define:vars={{ height: `${height}px` }}>
  .card {
    position: relative;
    width: 100%;
    height: var(--height);
  }
  .card__body {
    position: absolute;
    inset: 0;
    background: #23262d;
    border: 1px solid #343841;
    padding: 1rem;
    display: flex;
    flex-direction: column;
  }
  .card:hover .card__body::before {
    opacity: 0.5;
  }
  .card:hover .card__shadow {
    transform: translate(
      clamp(-32px, calc(var(--x) * 64px), 32px),
      clamp(16px, calc(var(--y) * -16px), 16px)
    );
  }
  .card__shadow {
    position: absolute;
    inset: 0;
    pointer-events: none;
    background: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0),
      rgba(0, 0, 0, 0.1) 45px,
      rgba(0, 0, 0, 0.2)
    );
    box-shadow: 0px 327px 131px rgba(0, 0, 0, 0.01),
      0px 184px 110px rgba(0, 0, 0, 0.05), 0px 82px 82px rgba(0, 0, 0, 0.09),
      0px 20px 45px rgba(0, 0, 0, 0.1), 0px 0px 0px rgba(0, 0, 0, 0.1);
    transform: translate(0, 0);
    transition: transform 300ms ease-out;
    filter: blur(4px);
    mix-blend-mode: overlay;
  }
  .card__body::before {
    --border-width: 1px;
    content: "";
    position: absolute;
    inset: 0;
    clip-path: polygon(
      0% 0%,
      0% calc(100% - var(--border-width)),
      var(--border-width) calc(100% - var(--border-width)),
      var(--border-width) var(--border-width),
      calc(100% - var(--border-width)) var(--border-width),
      calc(100% - var(--border-width)) calc(100% - var(--border-width)),
      var(--border-width) calc(100% - var(--border-width)),
      var(--border-width) 100%,
      100% 100%,
      100% 0%
    );
    background-image: radial-gradient(white, transparent 75%);
    background-position-x: calc(var(--x) * (var(--height) * -1));
    background-position-y: -240px;
    background-repeat: no-repeat;
    pointer-events: none;
    z-index: 1;
    opacity: 0;
    transition: opacity 300ms ease-out;
  }
  .card__body::after {
    position: absolute;
    content: "";
    mix-blend-mode: overlay;
    opacity: 0.2;
    inset: 0;
    width: 100%;
    height: 100%;
    background: url(/whitenoise.png);
    background-repeat: repeat;
    pointer-events: none;
  }
</style>
